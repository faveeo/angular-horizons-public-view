!function(e){e.module("angularHorizonsPublicView.directives",[]),e.module("angularHorizonsPublicView.filters",["rt.iso8601"]),e.module("angularHorizonsPublicView.faveeoApi",["restangular"]),e.module("angularHorizonsPublicView.factories",[]),e.module("angularHorizonsPublicView.simpleView",[]),e.module("angularHorizonsPublicView",["angularHorizonsPublicView.directives","angularHorizonsPublicView.filters","angularHorizonsPublicView.faveeoApi","angularHorizonsPublicView.factories","angularHorizonsPublicView.simpleView"])}(angular),angular.module("angularHorizonsPublicView.directives").directive("fallbackTwitterSrcImg",function(){return{link:function(e,t,n){t.on("error",function(){t[0].src="http://avatars.io/twitter/"+n.fallbackTwitterSrcImg})}}}),function(e){e.filter("default",function(){return function(e,t){return e&&""!==e?e:t}}),e.filter("cut",function(){return function(e,t,n,r){if(!e)return"";if(n=parseInt(n,10),!n)return e;if(e.length<=n)return e;if(e=e.substr(0,n),t){var a=e.lastIndexOf(" ");-1!=a&&(e=e.substr(0,a))}return e+(r||" â€¦")}}),e.filter("twitterBigger",function(){return function(e){return e.replace("_normal","_bigger")}}),e.filter("twitterFull",function(){return function(e){return e.replace("_normal","").replace("_bigger","")}}),e.filter("cleanHostName",function(){return function(e){return e=e.replace(/^https?:\/\//,""),"/"==e.substr(-1)&&(e=e.substr(0,e.length-1)),e}}),e.filter("cleanDomainName",function(){return function(e){return e=e.replace(/^https?:\/\//,""),"/"==e.substr(-1)&&(e=e.substr(0,e.length-1)),e.split("/")[0]}}),e.filter("timeSince",function(e){return function(t){"object"!=typeof t&&(t="string"==typeof t?e.parse(t):new Date(t));var n,r=Math.floor((new Date-t)/1e3),a=Math.floor(r/31536e3);return a>=1?n="year":(a=Math.floor(r/2592e3),a>=1?n="month":(a=Math.floor(r/86400),a>=1?n="day":(a=Math.floor(r/3600),a>=1?n="hour":(a=Math.floor(r/60),a>=1?n="minute":(a=r,n="second"))))),(a>1||0===a)&&(n+="s"),a+" "+n}}),e.filter("nl2br",function(e){return function(t,n){n=n||!0;var r=n?"<br />":"<br>";return t=(t+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1"+r+"$2"),e.trustAsHtml(t)}}),e.filter("numberFormat",function(){return function(e){if(e>0){var t=Math.abs(e);t>=Math.pow(10,12)?e=(e/Math.pow(10,12)).toFixed(1)+"t":t<Math.pow(10,12)&&t>=Math.pow(10,9)?e=(e/Math.pow(10,9)).toFixed(1)+"b":t<Math.pow(10,9)&&t>=Math.pow(10,6)?e=(e/Math.pow(10,6)).toFixed(1)+"m":t<Math.pow(10,6)&&t>=Math.pow(10,3)&&(e=(e/Math.pow(10,3)).toFixed(1)+"k")}return e}}),e.filter("to_trusted_html",["$sce",function(e){return function(t){return e.trustAsHtml(t)}}]),e.filter("getYoutubeId",function(){return function(e){if(e.match(/(youtube.com)/)){var t=e.split("v=")[1],n=t.replace(/(&)+(.*)/,"");return n}return""}})}(angular.module("angularHorizonsPublicView.filters")),function(e){e.factory("FaveeoApiInfluencers",["$q","Restangular","HttpErrorHandler",function(e,t,n){var r={};return r.path="twitterinfluencers2/",r.restangularAPI=t.all(r.path),r.getExamples=function(e,t,a){r.restangularAPI.one(e+"/examples").getList().then(t,n.useDefaultCallbackIfUndefined(a))},r.getInfluencers=function(e,t,a){r.restangularAPI.one(e+"/influencers").getList().then(t,n.useDefaultCallbackIfUndefined(a))},r}])}(angular.module("angularHorizonsPublicView.faveeoApi")),function(e){e.factory("FaveeoApiConfig",function(e){var t={};return t.init=function(t){e.setDefaultHeaders({"Content-Type":"application/json"}),e.setBaseUrl(t)},t}),e.factory("FaveeoApiHorizonsContent",["$q","Restangular",function(e,t){var n={};return n.path="twitterinfluencers2/",n.restangularAPI=t.all(n.path),n.getContent=function(e,t,r,a,i,o,s){var l={page:r,pagesize:a},c=parseInt(t);c>0&&(l.from="d"+c),i===!0&&(l.cb=(new Date).getTime()*(Math.random()+1)),n.restangularAPI.withHttpConfig({timeout:n.getContentDeferred.promise}).customGET(e+"/content",l).then(o,s)},n.getContentDeferred=e.defer(),n.abortGetContent=function(){n.getContentDeferred.resolve(),n.getContentDeferred=e.defer()},n.getArticleForUrl=function(e){var t={url:e};return n.restangularAPI.withHttpConfig({timeout:n.getArticleForUrlDeferred.promise}).customGET("articleforurl",t)},n.getArticleForUrlDeferred=e.defer(),n.abortGetArticleForUrl=function(){n.getArticleForUrlDeferred.resolve(),n.getArticleForUrlDeferred=e.defer()},n}])}(angular.module("angularHorizonsPublicView.faveeoApi")),function(e){e.factory("FaveeoApiSpecificContent",["$q","Restangular","HttpErrorHandler",function(e,t,n){var r={};return r.path="horizons/v1/",r.restangularAPI=t.all(r.path),r.getContent=function(e,t,a,i,o,s,l,c,u){var g={page:i,pagesize:o},d=parseInt(t);d>0&&(g.to="d"+d);var f=parseInt(a);f>0&&(g.from="d"+(f+d)),angular.forEach(s,function(e,t){g[t]=e}),l===!0&&(g.cb=(new Date).getTime()*(Math.random()+1)),r.restangularAPI.withHttpConfig({timeout:r.getContentDeferred.promise}).customGET(e+"/public/content",g).then(function(e){c(e.content)},n.useDefaultCallbackIfUndefined(u))},r.getContentDeferred=e.defer(),r.abortGetContent=function(){r.getContentDeferred.resolve(),r.getContentDeferred=e.defer()},r}])}(angular.module("angularHorizonsPublicView.faveeoApi")),function(e){e.factory("HttpErrorEvents",function(){var e={};return e.HTTP_ERROR_4XX="HTTP_ERROR_4XX",e.HTTP_ERROR_5XX="HTTP_ERROR_5XX",e.HTTP_OTHER_ERROR="HTTP_OTHER_ERROR",e.HTTP_ERROR="HTTP_ERROR",e})}(angular.module("angularHorizonsPublicView.factories")),function(e){"use strict";e.factory("HttpErrorHandler",function(e,t){var n={};return n.useDefaultCallbackIfUndefined=function(e){return angular.isFunction(e)?e:n.defaultErrorCallback},n.defaultErrorCallback=function(n){switch(e.$broadcast(t.HTTP_ERROR,"Sorry, an unexpected error happened ("+n.status+"). Please report the issue or try again later."),n.status){case 404:case 408:e.$broadcast(t.HTTP_ERROR_4XX,"Sorry, the server could not be reached. Please check your connection and try again");break;case 500:case 501:case 502:case 503:case 504:case 505:e.$broadcast(t.HTTP_ERROR_5XX,"Sorry, our servers are experiencing some troubles. Our team is working on it. Please try again later.");break;default:e.$broadcast(t.HTTP_OTHER_ERROR,"Sorry, an unexpected error happened ("+n.status+"). Please report the issue or try again later.")}},n})}(angular.module("angularHorizonsPublicView.factories")),angular.module("angularHorizonsPublicView.directives").directive("article",function(){return{restrict:"E",scope:{baseline:"=",showimages:"="},templateUrl:"angular-horizons-public-view/directives/article/article.tpl.html",replace:!0,controller:["$scope","FaveeoApiHorizonsContent",function(e,t){function n(e){return r.automaticsummary=e.excerpt,r.imageurl=e.imageurl,r.title=e.title,angular.isDefined(e.pubdate)&&(r.pubdate=e.pubdate),r}e.article={twitterReferences:e.baseline.twitterReferences,highlights:e.baseline.highlights};var r=e.baseline.document;angular.isUndefined(r.extractorType)||"faveeo"===r.extractorType?t.getArticleForUrl(r.url).then(function(t){e.article.document=angular.isDefined(t)?n(t):r},function(){e.article.document=r}):e.article.document=r}]}}),angular.module("angularHorizonsPublicView.directives").directive("classicarticle",function(){return{restrict:"E",scope:{entry:"=",trefs:"=",highlights:"=",showimages:"=",onclose:"&"},data:"",templateUrl:"angular-horizons-public-view/directives/classicArticle/classicArticle.tpl.html",replace:!0,controller:["$scope","$rootScope","$timeout",function(e,t,n){function r(){"undefined"!=typeof addthis?e.$evalAsync(function(){e.updateAddThis()}):n(r,500)}e.assetspath=angular.isDefined(t.assetsPath)?t.assetsPath.replace(/\/$/,""):"assets",e.addThisClass="addthis"+(new Date).getTime()+Math.random(),e.showShareButtons=!1,e.showShare=!1,e.hasArticle=function(){return angular.isDefined(e.entry)},e.updateAddThis=function(){addthis.toolbox("."+e.addThisClass,{},{url:e.entry.url,title:e.entry.title,description:e.entry.automaticsummary})},n(r,200)}]}}),angular.module("angularHorizonsPublicView.directives").directive("httperrorwarning",function(){"use strict";return{restrict:"E",scope:{only_global_error:"="},templateUrl:"angular-horizons-public-view/directives/httpErrorWarning/httperrorwarning.tpl.html",replace:!0,controller:["$scope","HttpErrorEvents",function(e,t){e.hideErrors=function(){e.isError=!1,e.errorValue=""};var n=e.only_global_error||!1;n?e.$on(t.HTTP_ERROR,function(){e.isError=!0,e.errorValue="HTTP_ERRORS.ALL"}):(e.$on(t.HTTP_ERROR_4XX,function(){e.isError=!0,e.errorValue="HTTP_ERRORS.4XX"}),e.$on(t.HTTP_ERROR_5XX,function(){e.isError=!0,e.errorValue="HTTP_ERRORS.5XX"}),e.$on(t.HTTP_OTHER_ERROR,function(){e.isError=!0,e.errorValue="HTTP_ERRORS.OTHER"})),e.hideErrors()}]}}),function(e){e.directive("simpleview",function(){return{restrict:"EA",templateUrl:"angular-horizons-public-view/directives/simpleView/simpleView.tpl.html",scope:{config:"="},replace:!1,controller:["$scope","$rootScope","FaveeoApiHorizonsContent",function(e,t,n){e.lastArticleLoaded=!1,e.loading=!1,e.articles=[],e.page=1,e.dateRange=e.config.dateRange,e.pageSize=e.config.pageSize,e.socialMagazineId=e.config.socialMagazineId,e.newPage=function(){e.articles=[],e.page=1,e.getContent()},e.setNewDateRange=function(t){e.dateRange=t,e.init()},e.getContent=function(){n.abortGetArticleForUrl(),n.abortGetContent(),e.loading=!0,n.getContent(e.socialMagazineId,e.dateRange,e.page,e.pageSize,!1,function(t){e.lastArticleLoaded=!0;try{if(angular.isDefined(t.content)&&t.content.length>0){if(!e.config.showImages)for(var n in t.content)t.content[n].document.imageurl=null;e.articles.push.apply(e.articles,t.content),e.lastArticleLoaded=!1}e.loading=!1}catch(r){e.loading=!1,console.log("Error parsing articles:\n\n"+r)}},function(t){e.lastArticleLoaded=!0,t.config.timeout||(console.log("Error loading articles:\n\n"+t),e.loading=!1)})},e.getNextPage=function(){e.page++,e.getContent()},e.newPage()}]}})}(angular.module("angularHorizonsPublicView.simpleView")),angular.module("angularHorizonsPublicView").run(["$templateCache",function(e){e.put("angular-horizons-public-view/directives/article/article.tpl.html",'<div>\n  <classicarticle ng-if="article.document" entry="article.document" showimages="showimages" trefs="article.twitterReferences" highlights="article.highlights" shareassetspath="{{assetspath}}"></classicarticle>\n</div>\n'),e.put("angular-horizons-public-view/directives/classicArticle/classicArticle.tpl.html",'<div class="article" ng-mouseover="isHover = true" ng-mouseleave="showShareButtons = false; isHover = false">\n    <div ng-show="hasArticle()">\n        <h6 class="mg-md clearfix" ng-dblclick="showHighlight=!showHighlight" ng-show="entry.pubdate">\n            <span class="float-left">{{entry.pubdate | timeSince}} ago</span>\n        </h6>\n\n        <div class="boxmask" ng-if="showimages">\n            <a href="{{entry.url}}" target="_blank">\n                <img ng-src="{{entry.imageurl}}"\n                     class="img-responsive" article-image>\n            </a>\n        </div>\n        <div>\n            <h5 class="mg-md">\n                <a href="{{entry.url}}" target="_blank"\n                   >\n                    {{entry.title | default:\'Click here to view article\'}}\n                </a>\n            </h5>\n\n            <p class="summary">\n                <a href="{{entry.url}}" target="_blank"\n                   ng-bind-html="entry.automaticsummary | cut:true:535:\' ...\' | nl2br">\n                </a>\n            </p>\n            <dl class="highlights" ng-repeat="hlt in highlights" ng-if="showHighlight">\n                <dt>In {{hlt.field}}:</dt>\n                <dd ng-repeat="fragment in hlt.fragments" ng-bind-html="fragment|to_trusted_html"></dd>\n            </dl>\n            <h6 class="mg-md" ng-if="entry.urlFQDN">\n                <a href="{{entry.url}}" target="_blank">\n                    {{entry.urlFQDN | cleanHostName}}\n                </a>\n            </h6>\n        </div>\n    </diV>\n    <span class="twitter-img" ng-repeat="tr in trefs">\n        <a href="{{tr.tweetURL}}" target="_blank">\n            <img class="img-thumbnail twitteruser-img" ng-src="{{tr.authorImageURL}}"\n                 alt="{{tr.authorName}}" fallback-twitter-src-img="{{tr.authorName}}"/>\n        </a>\n    </span>\n    <hr>\n    <div class="share-container text-center" ng-show="hasArticle()">\n        <div class="action-buttons text-center">\n            <a href="" ng-click="showShareButtons = true" ng-show="isHover">\n                <i class="fa fa-share-alt"></i> Share Article\n            </a>\n        </div>\n        <!-- AddThis Button BEGIN -->\n        <div data-addthis-toolbox data-url="{{entry.url}}" data-title="{{entry.title}}"\n             data-description="{{entry.automaticsummary}}"\n             class="addthis_toolbox addthis_default_style {{addThisClass}}" ng-show="showShareButtons">\n            <a class="addthis_button_twitter"><img ng-src="{{assetspath+\'/shareIcons/twitter.png\'}}"></a>\n            <a class="addthis_button_facebook"><img ng-src="{{assetspath+\'/shareIcons/facebook.png\'}}"></a>\n            <a class="addthis_button_linkedin"><img ng-src="{{assetspath+\'/shareIcons/linkedin.png\'}}"></a>\n            <a class="addthis_button_google_plusone_share"><img ng-src="{{assetspath+\'/shareIcons/googleplus.png\'}}"></a>\n            <a class="addthis_button_evernote"><img ng-src="{{assetspath+\'/shareIcons/evernote.png\'}}"></a>\n            <a class="addthis_button_mailto"><img ng-src="{{assetspath+\'/shareIcons/mail.png\'}}"></a>\n            <a class="addthis_button_pocket"><img ng-src="{{assetspath+\'/shareIcons/pocket.png\'}}"></a>\n            <a class="addthis_button_buffer"><img ng-src="{{assetspath+\'/shareIcons/buffer.png\'}}"></a>\n        </div>\n    </div>\n</div>\n'),e.put("angular-horizons-public-view/directives/httpErrorWarning/httperrorwarning.tpl.html",'<div class="http-error-warning-container warning-container"  ng-show="isError">\n    <div class="row col-xs-12 text-center well http-error-text">\n        <span class="">{{ errorValue | translate }}\n        </span>\n        <button type="button" class="close" aria-label="Close" ng-click="hideErrors();">\n            <span aria-hidden="true">&times;</span>\n        </button>\n    </div>\n</div>\n'),e.put("angular-horizons-public-view/directives/simpleView/simpleView.tpl.html",'<div class="simpleview-container" ng-cloak ng-show="socialMagazineId!=\'\'">\n    <section class="article-container">\n        <div class="row">\n            <div ng-repeat="article in articles">\n                <div ng-if="$index % 2 == 0" class="clearfix visible-md-block"></div>\n                <div ng-if="$index % 3 == 0" class="clearfix visible-lg-block"></div>\n                <div class="col-lg-4 col-md-6 col-sm-12 col-xs-12 text-left">\n                    <article baseline="article" showimages="config.showImages"></article>\n                </div>\n            </div>\n        </div>\n        <div class="row text-center show-more" ng-show="!lastArticleLoaded && !loading">\n            <button class="btn btn-default show-more-button" ng-click="getNextPage()">\n                Show more\n            </button>\n        </div>\n    </section>\n\n    <div class="container">\n        <div ng-show="articles.length == 0 && !loading">\n            <div class="row">\n                <div class="col-xs-12 text-center ">\n                    <h3 class="text-warning">Sorry no articles found for that period of time.</h3>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div class="loading row" ng-show="loading">\n        <div class="col-xs-12 text-center">\n            <i class="fa fa-refresh fa-spin fa-5x"></i>\n        </div>\n    </div>\n\n    <script src="//s7.addthis.com/js/300/addthis_widget.js#pubid="></script>\n</div>\n')}]);