!function(e){e.module("angularHorizonsPublicView.directives",[]),e.module("angularHorizonsPublicView.filters",["rt.iso8601"]),e.module("angularHorizonsPublicView.faveeoApi",["restangular"]),e.module("angularHorizonsPublicView.simpleView",[]),e.module("angularHorizonsPublicView",["angularHorizonsPublicView.directives","angularHorizonsPublicView.filters","angularHorizonsPublicView.faveeoApi","angularHorizonsPublicView.simpleView"])}(angular),function(e){e.factory("FaveeoApiConfig",function(e){var t={};return t.init=function(t){e.setDefaultHeaders({"Content-Type":"application/json"}),e.setBaseUrl(t)},t}),e.factory("FaveeoApiHorizonsContent",["$q","Restangular",function(e,t){var n={};return n.path="twitterinfluencers2/",n.restangularAPI=t.all(n.path),n.getContent=function(e,t,i,a,r,s,o){var l={page:i,pagesize:a},c=parseInt(t);c>0&&(l.from="d"+c),r===!0&&(l.cb=(new Date).getTime()*(Math.random()+1)),n.restangularAPI.withHttpConfig({timeout:n.getContentDeferred.promise}).customGET(e+"/content",l).then(s,o)},n.getContentDeferred=e.defer(),n.abortGetContent=function(){n.getContentDeferred.resolve(),n.getContentDeferred=e.defer()},n.getArticleForUrl=function(e){var t={url:e};return n.restangularAPI.withHttpConfig({timeout:n.getArticleForUrlDeferred.promise}).customGET("articleforurl",t)},n.getArticleForUrlDeferred=e.defer(),n.abortGetArticleForUrl=function(){n.getArticleForUrlDeferred.resolve(),n.getArticleForUrlDeferred=e.defer()},n}])}(angular.module("angularHorizonsPublicView.faveeoApi")),function(e){e.filter("default",function(){return function(e,t){return e&&""!==e?e:t}}),e.filter("cut",function(){return function(e,t,n,i){if(!e)return"";if(n=parseInt(n,10),!n)return e;if(e.length<=n)return e;if(e=e.substr(0,n),t){var a=e.lastIndexOf(" ");-1!=a&&(e=e.substr(0,a))}return e+(i||" â€¦")}}),e.filter("twitterBigger",function(){return function(e){return e.replace("_normal","_bigger")}}),e.filter("twitterFull",function(){return function(e){return e.replace("_normal","").replace("_bigger","")}}),e.filter("cleanHostName",function(){return function(e){return e=e.replace(/^https?:\/\//,""),"/"==e.substr(-1)&&(e=e.substr(0,e.length-1)),e}}),e.filter("timeSince",function(e){return function(t){"object"!=typeof t&&(t="string"==typeof t?e.parse(t):new Date(t));var n,i=Math.floor((new Date-t)/1e3),a=Math.floor(i/31536e3);return a>=1?n="year":(a=Math.floor(i/2592e3),a>=1?n="month":(a=Math.floor(i/86400),a>=1?n="day":(a=Math.floor(i/3600),a>=1?n="hour":(a=Math.floor(i/60),a>=1?n="minute":(a=i,n="second"))))),(a>1||0===a)&&(n+="s"),a+" "+n}}),e.filter("nl2br",function(e){return function(t,n){n=n||!0;var i=n?"<br />":"<br>";return t=(t+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1"+i+"$2"),e.trustAsHtml(t)}}),e.filter("numberFormat",function(){return function(e){if(e>0){var t=Math.abs(e);t>=Math.pow(10,12)?e=(e/Math.pow(10,12)).toFixed(1)+"t":t<Math.pow(10,12)&&t>=Math.pow(10,9)?e=(e/Math.pow(10,9)).toFixed(1)+"b":t<Math.pow(10,9)&&t>=Math.pow(10,6)?e=(e/Math.pow(10,6)).toFixed(1)+"m":t<Math.pow(10,6)&&t>=Math.pow(10,3)&&(e=(e/Math.pow(10,3)).toFixed(1)+"k")}return e}}),e.filter("to_trusted_html",["$sce",function(e){return function(t){return e.trustAsHtml(t)}}])}(angular.module("angularHorizonsPublicView.filters")),angular.module("angularHorizonsPublicView.directives").directive("classicarticle",function(){return{restrict:"E",scope:{entry:"=",trefs:"=",highlights:"=",showimages:"=",onclose:"&"},data:"",templateUrl:"angular-horizons-public-view/directives/classicArticle/classicArticle.tpl.html",replace:!0,controller:["$scope","$rootScope","$timeout",function(e,t,n){function i(){"undefined"!=typeof addthis?e.$evalAsync(function(){e.updateAddThis()}):n(i,500)}e.assetspath=angular.isDefined(t.assetsPath)?t.assetsPath.replace(/\/$/,""):"assets",e.addThisClass="addthis"+(new Date).getTime()+Math.random(),e.showShareButtons=!1,e.showShare=!1,e.hasArticle=function(){return angular.isDefined(e.entry)},e.updateAddThis=function(){addthis.toolbox("."+e.addThisClass,{},{url:e.entry.url,title:e.entry.title,description:e.entry.automaticsummary})},n(i,200)}]}}),angular.module("angularHorizonsPublicView.directives").directive("article",function(){return{restrict:"E",scope:{baseline:"=",showimages:"="},templateUrl:"angular-horizons-public-view/directives/article/article.tpl.html",replace:!0,controller:["$scope","FaveeoApiHorizonsContent",function(e,t){function n(e){return i.automaticsummary=e.excerpt,i.imageurl=e.imageurl,i.title=e.title,angular.isDefined(e.pubdate)&&(i.pubdate=e.pubdate),i}e.article={twitterReferences:e.baseline.twitterReferences,highlights:e.baseline.highlights};var i=e.baseline.document;angular.isUndefined(i.extractorType)||"faveeo"===i.extractorType?t.getArticleForUrl(i.url).then(function(t){e.article.document=angular.isDefined(t)?n(t):i},function(){e.article.document=i}):e.article.document=i}]}}),function(e){e.directive("simpleview",function(){return{restrict:"EA",templateUrl:"angular-horizons-public-view/directives/simpleView/simpleView.tpl.html",scope:{config:"="},replace:!1,controller:["$scope","$rootScope","FaveeoApiHorizonsContent",function(e,t,n){e.lastArticleLoaded=!1,e.loading=!1,e.articles=[],e.page=1,e.dateRange=e.config.dateRange,e.pageSize=e.config.pageSize,e.socialMagazineId=e.config.socialMagazineId,e.newPage=function(){e.articles=[],e.page=1,(angular.isUndefined(e.config.multiContentPage)||!e.config.multiContentPage)&&(n.abortGetArticleForUrl(),n.abortGetContent()),e.getContent()},e.setNewDateRange=function(t){e.dateRange=t,e.newPage()},e.getContent=function(){e.loading=!0,n.getContent(e.socialMagazineId,e.dateRange,e.page,e.pageSize,!1,function(t){e.lastArticleLoaded=!0;try{if(angular.isDefined(t.content)&&t.content.length>0){if(!e.config.showImages)for(var n in t.content)t.content[n].document.imageurl=null;e.articles.push.apply(e.articles,t.content),e.lastArticleLoaded=!1}e.loading=!1}catch(i){e.loading=!1,console.log("Error parsing articles:\n\n"+i)}},function(t){e.lastArticleLoaded=!0,t.config.timeout||(console.log("Error loading articles:\n\n"+t),e.loading=!1)})},e.getNextPage=function(){e.page++,e.getContent()},e.newPage()}]}})}(angular.module("angularHorizonsPublicView.simpleView")),angular.module("angularHorizonsPublicView").run(["$templateCache",function(e){e.put("angular-horizons-public-view/directives/article/article.tpl.html",'<div>\n  <classicarticle ng-if="article.document" entry="article.document" showimages="showimages" trefs="article.twitterReferences" highlights="article.highlights" shareassetspath="{{assetspath}}"></classicarticle>\n</div>\n'),e.put("angular-horizons-public-view/directives/classicArticle/classicArticle.tpl.html",'<div class="article" ng-mouseover="isHover = true" ng-mouseleave="showShareButtons = false; isHover = false">\n    <div ng-show="hasArticle()">\n        <h6 class="mg-md clearfix" ng-dblclick="showHighlight=!showHighlight" ng-show="entry.pubdate">\n            <span class="float-left">{{entry.pubdate | timeSince}} ago</span>\n        </h6>\n\n        <div class="boxmask" ng-if="showimages">\n            <a href="{{entry.url}}" target="_blank">\n                <img ng-src="{{entry.imageurl}}"\n                     class="img-responsive" article-image>\n            </a>\n        </div>\n        <div>\n            <h5 class="mg-md">\n                <a href="{{entry.url}}" target="_blank"\n                   >\n                    {{entry.title | default:\'Click here to view article\'}}\n                </a>\n            </h5>\n\n            <p class="summary">\n                <a href="{{entry.url}}" target="_blank"\n                   ng-bind-html="entry.automaticsummary | cut:true:535:\' ...\' | nl2br">\n                </a>\n            </p>\n            <dl class="highlights" ng-repeat="hlt in highlights" ng-if="showHighlight">\n                <dt>In {{hlt.field}}:</dt>\n                <dd ng-repeat="fragment in hlt.fragments" ng-bind-html="fragment|to_trusted_html"></dd>\n            </dl>\n            <h6 class="mg-md" ng-if="entry.urlFQDN">\n                <a href="{{entry.url}}" target="_blank">\n                    {{entry.urlFQDN | cleanHostName}}\n                </a>\n            </h6>\n        </div>\n    </diV>\n    <span class="twitter-img" ng-repeat="tr in trefs">\n        <a href="{{tr.tweetURL}}" target="_blank">\n            <img class="img-thumbnail twitteruser-img" ng-src="{{tr.authorImageURL}}"\n                 alt="{{tr.authorName}}" fallback-twitter-src-img="{{tr.authorName}}"/>\n        </a>\n    </span>\n    <hr>\n    <div class="share-container text-center" ng-show="hasArticle()">\n        <div class="action-buttons text-center">\n            <a href="" ng-click="showShareButtons = true" ng-show="isHover">\n                <i class="fa fa-share-alt"></i> Share Article\n            </a>\n        </div>\n        <!-- AddThis Button BEGIN -->\n        <div data-addthis-toolbox data-url="{{entry.url}}" data-title="{{entry.title}}"\n             data-description="{{entry.automaticsummary}}"\n             class="addthis_toolbox addthis_default_style {{addThisClass}}" ng-show="showShareButtons">\n            <a class="addthis_button_twitter"><img ng-src="{{assetspath+\'/shareIcons/twitter.png\'}}"></a>\n            <a class="addthis_button_facebook"><img ng-src="{{assetspath+\'/shareIcons/facebook.png\'}}"></a>\n            <a class="addthis_button_linkedin"><img ng-src="{{assetspath+\'/shareIcons/linkedin.png\'}}"></a>\n            <a class="addthis_button_google_plusone_share"><img ng-src="{{assetspath+\'/shareIcons/googleplus.png\'}}"></a>\n            <a class="addthis_button_evernote"><img ng-src="{{assetspath+\'/shareIcons/evernote.png\'}}"></a>\n            <a class="addthis_button_mailto"><img ng-src="{{assetspath+\'/shareIcons/mail.png\'}}"></a>\n            <a class="addthis_button_pocket"><img ng-src="{{assetspath+\'/shareIcons/pocket.png\'}}"></a>\n            <a class="addthis_button_buffer"><img ng-src="{{assetspath+\'/shareIcons/buffer.png\'}}"></a>\n        </div>\n    </div>\n</div>\n'),e.put("angular-horizons-public-view/directives/simpleView/simpleView.tpl.html",'<div class="simpleview-container" ng-cloak ng-show="socialMagazineId!=\'\'">\n    <section class="article-container">\n        <div class="row">\n            <div ng-repeat="article in articles">\n                <div ng-if="$index % 2 == 0" class="clearfix visible-md-block"></div>\n                <div ng-if="$index % 3 == 0" class="clearfix visible-lg-block"></div>\n                <div class="col-lg-4 col-md-6 col-sm-12 col-xs-12 text-left">\n                    <article baseline="article" showimages="config.showImages"></article>\n                </div>\n            </div>\n        </div>\n        <div class="row text-center show-more" ng-show="!lastArticleLoaded && !loading">\n            <button class="btn btn-default show-more-button" ng-click="getNextPage()">\n                Show more\n            </button>\n        </div>\n    </section>\n\n    <div class="container">\n        <div ng-show="articles.length == 0 && !loading">\n            <div class="row">\n                <div class="col-xs-12 text-center ">\n                    <h3 class="text-warning">Sorry no articles found for that period of time.</h3>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div class="loading row" ng-show="loading">\n        <div class="col-xs-12 text-center">\n            <i class="fa fa-refresh fa-spin fa-5x"></i>\n        </div>\n    </div>\n\n    <script src="//s7.addthis.com/js/300/addthis_widget.js#pubid="></script>\n</div>\n')}]);